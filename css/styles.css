:root{
  /* Paleta y parámetros */
  --bg-deep:#05060F;
  --txt:#F7F7F5;

  /* Flor */
  --petal-highlight: #FFE589;
  --leaf:#3FA263;
  --leaf-dark:#2C7D4A;
  --stem:#2F7B32;
  --edge-gold:#EED28A;
  --halo:#EACB76;

  /* Animación */
  --fast:220ms; --med:480ms; --slow:900ms;
  --ease: cubic-bezier(.215,.61,.355,1);

  /* Galaxia */
  --twinkle: 3.2s;
  --drift-near: 80s;
  --drift-far: 140s;
  --rotate-a: 120s;
  --rotate-b: 180s;
  --rotate-c: 240s;

  --max-w: 980px;
}

*{ box-sizing:border-box; }
html, body{ height:100%; }
body{
  margin:0; background:var(--bg-deep); color:var(--txt);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans";
  overflow-x:hidden;
}

/* --- ESPACIO --- */
.space{ position:fixed; inset:0; z-index:-3; overflow:hidden; }

.nebula{
  position:absolute; inset:-10%;
  filter: blur(18px) saturate(110%);
  opacity:.35; mix-blend-mode: screen;
  will-change: transform, opacity;
}

/* Tres nebulosas que rotan a diferentes velocidades */
.nebula-a{
  background:
    radial-gradient(50% 40% at 60% 40%, rgba(140,70,210,.55), transparent 65%),
    radial-gradient(40% 35% at 30% 65%, rgba(255,180,120,.45), transparent 65%);
  animation: spinA var(--rotate-a) linear infinite;
}
.nebula-b{
  background:
    radial-gradient(45% 35% at 70% 60%, rgba(80,160,255,.35), transparent 65%),
    radial-gradient(35% 30% at 40% 40%, rgba(255,240,160,.28), transparent 65%);
  animation: spinB var(--rotate-b) linear infinite reverse;
}
.nebula-c{
  background:
    radial-gradient(35% 30% at 50% 50%, rgba(200,110,240,.22), transparent 65%),
    radial-gradient(45% 35% at 35% 55%, rgba(255,200,140,.22), transparent 65%);
  animation: spinC var(--rotate-c) linear infinite;
}

@keyframes spinA { to { transform: rotate(360deg) scale(1.03); } }
@keyframes spinB { to { transform: rotate(360deg) scale(1.04); } }
@keyframes spinC { to { transform: rotate(360deg) scale(1.02); } }

/* Estrellas: dos capas con drift y parpadeo */
.stars{ position:absolute; inset:-5%; will-change: transform, opacity; }
.stars::before, .stars::after{
  content:""; position:absolute; inset:0;
  background-repeat:repeat; background-size: 900px 900px;
  filter: drop-shadow(0 0 1px rgba(255,255,255,.65));
  animation: twinkle var(--twinkle) ease-in-out infinite alternate;
}
.stars-near::before{
  background-image:
    radial-gradient(1.4px 1.4px at 10% 10%, rgba(255,255,255,.95) 40%, transparent 41%),
    radial-gradient(1.2px 1.2px at 80% 20%, rgba(255,255,255,.9) 40%, transparent 41%),
    radial-gradient(1.6px 1.6px at 30% 70%, rgba(255,255,255,.8) 40%, transparent 41%);
}
.stars-near::after{
  background-image:
    radial-gradient(1px 1px at 50% 50%, rgba(255,255,255,.8) 40%, transparent 41%),
    radial-gradient(1px 1px at 20% 80%, rgba(255,255,255,.7) 40%, transparent 41%);
  opacity:.7;
}
.stars-far::before{
  background-image:
    radial-gradient(.9px .9px at 60% 30%, rgba(255,255,255,.7) 40%, transparent 41%),
    radial-gradient(.8px .8px at 30% 60%, rgba(255,255,255,.6) 40%, transparent 41%),
    radial-gradient(.7px .7px at 75% 75%, rgba(255,255,255,.6) 40%, transparent 41%);
  opacity:.5;
}
.stars-far::after{
  background-image:
    radial-gradient(.7px .7px at 15% 20%, rgba(255,255,255,.55) 40%, transparent 41%),
    radial-gradient(.6px .6px at 85% 65%, rgba(255,255,255,.5) 40%, transparent 41%);
  opacity:.4;
}

/* drift continuo (parallax adicional via JS) */
.stars-near{ animation: driftNear var(--drift-near) linear infinite; }
.stars-far { animation: driftFar  var(--drift-far)  linear infinite; }
@keyframes driftNear { to { transform: translate3d(40px, -40px, 0); } }
@keyframes driftFar  { to { transform: translate3d(-60px, 30px, 0); } }

@keyframes twinkle {
  0% { opacity:.55; }
  100%{ opacity:.95; }
}

/* Meteoros (estrellas fugaces) */
.meteor{
  position:absolute; width:2px; height:2px; background: white;
  box-shadow: 0 0 6px 2px rgba(255,255,255,.8);
  transform: translate3d(0,0,0) rotate(45deg);
  opacity:0;
  will-change: transform, opacity;
}

/* --- LAYOUT --- */
main{
  min-height: 100dvh;
  display:grid; place-items:center;
  padding: 4rem 1rem 5rem; max-width:var(--max-w); margin:0 auto; text-align:center;
}

.ghost-btn{
  position:fixed; top:1rem; right:1rem;
  background: rgba(20,22,40,.25);
  color:var(--txt);
  border: 1px solid rgba(255,255,255,.25);
  border-radius: 999px; padding:.6rem 1rem;
  backdrop-filter: blur(6px) saturate(120%);
  cursor:pointer;
  transition: transform var(--fast) var(--ease), border-color var(--fast) var(--ease);
}
.ghost-btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.45); }
.ghost-btn:focus-visible{ outline:2px solid var(--halo); outline-offset:3px; }

/* --- FLOR --- */
.flower{
  margin:0; display:inline-block; filter: drop-shadow(0 12px 26px rgba(0,0,0,.4));
  transform-origin: 50% 100%;
  animation: sway 7s var(--ease) infinite alternate;
  will-change: transform, filter;
}
@keyframes sway{
  0%   { transform: rotate(-1.1deg) translateY(0); }
  100% { transform: rotate(1.1deg) translateY(-1px); }
}

.flower-svg{ display:block; }

/* Tallo y hojas */
.stem{
  fill:none; stroke: var(--stem); stroke-width:6; stroke-linecap:round;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,.35));
}
.leaves path.leaf{
  fill: url(#leafGrad);
}
.leaf{ fill: var(--leaf); filter: drop-shadow(0 2px 2px rgba(0,0,0,.25)); }
.vein{ fill:none; stroke: rgba(255,255,255,.15); stroke-width:1; opacity:.85; }
.vein.left  { stroke: rgba(255,255,255,.18); }
.vein.right { stroke: rgba(255,255,255,.18); }

/* Pétalos con gradiente y borde dorado suave */
.petals path{
  fill: url(#petalGrad1);
  stroke: rgba(160,120,40,.28);
  stroke-width: .7;
  paint-order: stroke fill;
  filter:
    drop-shadow(0 .5px 0 rgba(255,255,255,.12))
    drop-shadow(0 2px 4px rgba(0,0,0,.25));
  transform-origin: 180px 230px;
  transition: transform var(--med) var(--ease), filter var(--med) var(--ease);
}
.petals.back path{ opacity:.92; }
.petals.front path{
  opacity:.98;
  /* brillo sutil en borde */
  filter:
    drop-shadow(0 0 .5px rgba(255,255,255,.2))
    drop-shadow(0 3px 6px rgba(0,0,0,.3));
}

/* Centro */
.center{
  filter:
    drop-shadow(0 0 3px rgba(0,0,0,.25))
    drop-shadow(0 0 12px rgba(255,210,90,.18));
  transition: filter var(--fast) var(--ease);
}
.center-seeds{ opacity:.85; filter: saturate(110%); }
.center-halo{ transition: opacity var(--fast) var(--ease); }

/* Interacciones */
.flower:hover .petals path,
.flower:focus-visible .petals path{
  transform: scale(1.035);
  filter:
    drop-shadow(0 0 5px rgba(238,210,138,.28))
    drop-shadow(0 8px 14px rgba(0,0,0,.28));
}
.flower:hover .center, .flower:focus-visible .center{
  filter:
    drop-shadow(0 0 10px rgba(255,220,120,.45))
    drop-shadow(0 0 26px rgba(255,220,120,.28));
}
.flower:hover .center-halo, .flower:focus-visible .center-halo{ opacity:.95; }

/* Click: florecer */
.flower.bloom .petals path{ transform: scale(1.06); }

/* Mensaje */
.message{
  margin-top:1.2rem; max-width:min(92vw, 720px);
  background: rgba(10,12,22,.55);
  border: 1px solid rgba(255,255,255,.16);
  border-radius: 16px; padding: 1rem 1.25rem;
  backdrop-filter: blur(10px) saturate(120%);
  box-shadow: 0 10px 24px rgba(0,0,0,.28);
  transition: opacity var(--med) var(--ease), transform var(--med) var(--ease);
}
.message[hidden]{ display:block; opacity:0; transform: translateY(6px) scale(.985); height:0; padding:0 1.25rem; border-color:transparent; overflow:hidden; }
.message p{ margin:0; line-height:1.7; letter-spacing:.15px; }

/* Utilidad: accesibilidad */
.visually-hidden{
  position:absolute !important; height:1px; width:1px; overflow:hidden;
  clip: rect(1px,1px,1px,1px); white-space:nowrap; border:0; padding:0; margin:-1px;
}

/* Respeta reduce-motion */
@media (prefers-reduced-motion: reduce){
  .nebula, .stars, .flower { animation: none !important; }
}
